from ipaddress import ip_address

def get_country_from_ip(ip):
    """ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© Ù…Ù† Ø¹Ù†ÙˆØ§Ù† IP (Ù†Ø³Ø®Ø© Ù…Ø¨Ø³Ø·Ø©)"""
    # Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ù…Ø¨Ø³Ø·ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ©
    country_mapping = {
        '41': 'EG',  # Ù…ØµØ±
        '5': 'SA',   # Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
        '31': 'AE',  # Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª
        '188': 'KW', # Ø§Ù„ÙƒÙˆÙŠØª
        '134': 'QA', # Ù‚Ø·Ø±
    }
    
    try:
        # ØªØ­ÙˆÙŠÙ„ IP Ø¥Ù„Ù‰ Ø±Ù‚Ù…
        ip_num = int(ip_address(ip))
        
        # ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø·Ø§Ù‚ (Ù…Ø«Ø§Ù„ Ù…Ø¨Ø³Ø·)
        if 1973920000 <= ip_num <= 1973920255:
            return 'EG'
        elif 1973921024 <= ip_num <= 1973921279:
            return 'SA'
        elif 1973922048 <= ip_num <= 1973922303:
            return 'AE'
        else:
            return 'Unknown'
    except:
        return 'Unknown'

def get_flag_emoji_simple(country_code):
    """Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø¹Ù„Ù… Ù…Ø¨Ø³Ø·"""
    flags = {
        'EG': 'ðŸ‡ªðŸ‡¬',
        'SA': 'ðŸ‡¸ðŸ‡¦',
        'AE': 'ðŸ‡¦ðŸ‡ª',
        'KW': 'ðŸ‡°ðŸ‡¼',
        'QA': 'ðŸ‡¶ðŸ‡¦',
        'US': 'ðŸ‡ºðŸ‡¸',
        'GB': 'ðŸ‡¬ðŸ‡§',
        'FR': 'ðŸ‡«ðŸ‡·',
        'DE': 'ðŸ‡©ðŸ‡ª',
        'TR': 'ðŸ‡¹ðŸ‡·',
        'IN': 'ðŸ‡®ðŸ‡³',
        'CN': 'ðŸ‡¨ðŸ‡³',
        'RU': 'ðŸ‡·ðŸ‡º',
        'BR': 'ðŸ‡§ðŸ‡·',
    }
    return flags.get(country_code, 'ðŸŒ')